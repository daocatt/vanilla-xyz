{"version":3,"sources":["webpack://vanilla-admin/./packages/vanilla-utils/src/logicUtils.ts","webpack://vanilla-admin/./packages/vanilla-utils/src/mathUtils.ts","webpack://vanilla-admin/./packages/vanilla-utils/src/stringUtils.ts","webpack://vanilla-admin/./packages/vanilla-utils/src/systemUtils.ts","webpack://vanilla-admin/./packages/vanilla-utils/src/typeUtils.ts","webpack://vanilla-admin/./applications/dashboard/src/scripts/roles/RoleActions.ts","webpack://vanilla-admin/./node_modules/moment/locale sync en","webpack://vanilla-admin/./applications/dashboard/src/scripts/roles/roleReducer.ts","webpack://vanilla-admin/./packages/vanilla-i18n/src/localeStore.ts","webpack://vanilla-admin/./packages/vanilla-i18n/src/LocaleProvider.tsx","webpack://vanilla-admin/./packages/vanilla-i18n/src/translationStore.ts","webpack://vanilla-admin/./packages/vanilla-i18n/src/ContentTranslator.tsx","webpack://vanilla-admin/./packages/vanilla-i18n/src/ContentTranslationProvider.tsx","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/domData.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/emoji.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/EscapeListener.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/events.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/FocusWatcher.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/sanitization.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/scripts.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/shadowDom.tsx","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/TabHandler.ts","webpack://vanilla-admin/./packages/vanilla-dom-utils/src/index.ts","webpack://vanilla-admin/./packages/vanilla-react-utils/src/Hoverable.tsx","webpack://vanilla-admin/./packages/vanilla-react-utils/src/useMeasure.ts","webpack://vanilla-admin/./packages/vanilla-react-utils/src/useDomNodeAttachment.tsx","webpack://vanilla-admin/./packages/vanilla-react-utils/src/useEscapeListener.ts","webpack://vanilla-admin/./packages/vanilla-react-utils/src/useFocusWatcher.ts","webpack://vanilla-admin/./packages/vanilla-react-utils/src/useLastValue.tsx","webpack://vanilla-admin/./packages/vanilla-react-utils/src/useThrowError.ts","webpack://vanilla-admin/./packages/vanilla-utils/src/debugUtils.ts","webpack://vanilla-admin/./packages/vanilla-react-utils/src/mounting.tsx","webpack://vanilla-admin/./applications/dashboard/src/scripts/compatibilityStyles/cssOut.ts","webpack://vanilla-admin/./library/src/scripts/features/toaster/toastStyles.ts","webpack://vanilla-admin/./library/src/scripts/features/toaster/Toast.tsx","webpack://vanilla-admin/./library/src/scripts/features/toaster/themePreview/ThemePreviewToastReducer.ts","webpack://vanilla-admin/./library/src/scripts/features/toaster/themePreview/ThemePreviewToast.tsx","webpack://vanilla-admin/./applications/dashboard/src/scripts/entries/common.tsx","webpack://vanilla-admin/./build/entries/public-path.ts"],"names":["flattenObject","obj","delimiter","Object","keys","reduce","acc","key","prefix","length","Array","isArray","assign","simplifyFraction","numerator","denominator","gcd","findGCD","a","b","shorthand","hashString","str","split","prevHash","currVal","charCodeAt","labelize","label","replace","parts","map","s","charAt","toLocaleUpperCase","slice","join","slugify","options","whiteSpaceNormalizeRegexp","allowMultipleDashes","normalize","trim","toLocaleLowerCase","OS","SAFE_PROTOCOL_REGEX","sanitizeUrl","url","match","capitalizeFirstLetter","toUpperCase","guessOperatingSystem","userAgent","navigator","vendor","window","opera","test","ANDROID","MSStream","IOS","UNKNOWN","indexArrayByKey","array","object","item","push","notEmpty","value","ensureString","maybeString","TypeError","forceInt","fallback","result","Number","parseInt","isNaN","createAction","actionCreatorFactory","RoleActions","thunk","bindThunkAction","getAllACs","async","api","get","params","limit","response","data","dispatch","ReduxActions","useRoleActions","useReduxActions","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","resolve","module","exports","INITIAL_ROLE_STATE","rolesByID","status","LoadStatus","PENDING","roleReducer","produce","reducerWithInitialState","case","started","nextState","action","LOADING","done","payload","forEach","role","roleID","SUCCESS","failed","ERROR","error","currentLocale","localeStore","callbacks","getLocales","setCurrentLocale","localeKey","callback","getCurrentLocale","getJSLocaleKey","loadLocales","locales","LocaleContext","React","createContext","LocaleProvider","props","useState","setLocales","logWarning","useEffect","Provider","children","useLocaleInfo","useContext","translationStore","internalTranslationDebugValue","translationDebug","newValue","undefined","loadTranslations","translations","translate","defaultTranslation","substr","message","TranslationPropertyType","t","NullContentTranslator","logError","context","shouldDisplay","Translator","_TranslationComponent","ContentTranslationProvider","setTranslator","WeakMap","emojiSupportedCache","emojiOptions","className","size","convertToSafeEmojiCharacters","stringOrNode","canvas","document","createElement","getContext","ctx","fillText","getImageData","isEmojiSupported","twemoji","parse","EscapeListener","root","returnElement","addEventListener","keydownListener","removeEventListener","event","contains","activeElement","preventDefault","focus","delegatedEventListeners","delegateEvent","eventName","filterSelector","scopeSelector","scope","functionKey","toString","querySelector","HTMLElement","eventHash","includes","wrappedCallback","target","closest","call","FocusWatcher","watchedNode","changeHandler","handleFocusOut","handleFocusIn","handleClick","checkDomTreeHasFocus","triggeringElement","checkDomTreeWasClicked","clickedElement","this","setTimeout","relatedTarget","explicitOriginalTarget","body","isWatchedInBody","isFocusedInBody","isModal","Boolean","getElementById","hasFocus","escapeHTML","div","appendChild","createTextNode","innerHTML","loadEventCallbacks","rejectionCache","Map","ensureScript","scriptUrl","Promise","reject","existingScript","has","head","getElementsByTagName","script","type","src","onerror","set","timeout","onload","clearTimeout","delete","prepareShadowRoot","element","cloneElement","newElementTag","html","ns","append","startsWith","remove","browserEscapesNoScript","escapedString","child","childNodes","nodeValue","unescapeHTML","newElement","classList","parentNode","insertBefore","attachShadow","mode","TabHandler","documentElement","excludedElements","excludedRoots","exemption","elementToFilter","excludedRoot","tabbableElements","tabbable","from","reverse","allowLooping","tabbables","filter","createExcludeFilterWithExemption","currentTabIndex","indexOf","targetIndex","filterAllExcluded","smoothscroll","polyfill","Hoverable","hasExecuted","once","onHover","hoverTimeout","handleHover","duration","dismissTimeout","onMouseEnter","mouseEnterHandler","onMouseLeave","mouseLeaveHandler","Component","EMPTY_RECT","x","y","width","height","top","right","bottom","left","toJSON","useMeasure","ref","adjustForScrollOffset","watchRef","bounds","setContentRect","refWatch","current","useLayoutEffect","animationFrameId","measure","requestAnimationFrame","rect","getBoundingClientRect","scrollY","JSON","stringify","resizeListener","debounce","ro","ResizeObserver","observe","cancelAnimationFrame","disconnect","cancel","useDomNodeAttachment","domNodes","useRef","node","DomNodeAttacher","_props","nodes","useEscapeListener","actualRoot","escapeListener","start","stop","useFocusWatcher","bypass","focusWatcher","useLastValue","useThrowError","setError","internalDebugValue","debug","logDebug","console","log","logDebugConditionnal","outputLog","warn","hasRendered","portals","PORTAL_MANAGER_ID","PortalContext","Fragment","applySharedPortalContext","renderPortals","PortalManager","portal","i","ReactDOM","createPortal","component","container","render","mountReact","bypassPortalManager","unmountBeforeRender","unmountComponentAtNode","setImmediate","cleanupContainer","mountPoint","clearContents","overwrite","parentElement","firstElementChild","mountPortal","containerID","asRealPortal","cssOut","selector","objects","cssRaw","flattenNests","toastClasses","useThemeCache","globalVars","globalVariables","style","styleFactory","fontSize","fonts","medium","zIndex","position","display","Mixins","padding","horizontal","gutter","half","margin","styleUnit","quarter","border","shadowHelper","dropDown","background","ColorsUtils","colorOut","mainColors","bg","p","buttons","minHeight","buttonGlobalVariables","sizing","flexHelper","middleLeft","button","Toast","links","classes","classNames","link","Button","baseClass","title","name","onClick","isLoading","ButtonLoader","buttonType","DEFAULT_PREVIEW_TOASTER_STATE","applyStatus","cancelStatus","themePreviewToastReducer","ThemeActions","putCurrentThemeACs","themeID","putPreviewThemeACs","PreviewStatusType","CANCEL","ThemePreviewToast","useSelector","state","themePreviewToaster","getMeta","themePreview","useThemeActions","putCurrentTheme","putPreviewTheme","patchThemeWithRevisionID","restoringRevision","setRestoringRevision","revisionRestored","setRevisionRestored","isRevisionPreview","revisionID","location","href","redirect","ButtonTypes","TEXT","APPLY","TEXT_PRIMARY","ErrorMessages","errors","registerReducer","addComponent","onReady","__webpack_public_path__","assetUrl"],"mappings":"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","file":"addons/dashboard-common.min.js?6efc20d0f02179966a5f","sourcesContent":["/**\n * @author Adam Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2020 Vanilla Forums Inc.\n * @license gpl-2.0-only\n */\n\nimport set from \"lodash/set\";\n\nexport function spaceshipCompare(a, b): number {\n    if (a > b) {\n        return 1;\n    } else if (a < b) {\n        return -1;\n    } else {\n        return 0;\n    }\n}\n\nexport function flattenObject(obj: Record<any, any>, delimiter = \"\") {\n    return Object.keys(obj).reduce((acc, key) => {\n        const prefix = delimiter.length ? delimiter + \".\" : \"\";\n        if (typeof obj[key] === \"object\" && !Array.isArray(obj[key]) && obj[key] !== null) {\n            Object.assign(acc, flattenObject(obj[key], prefix + key));\n        } else {\n            acc[prefix + key] = obj[key];\n        }\n        return acc;\n    }, {});\n}\n\nexport function unflattenObject(original: Record<any, any>) {\n    const result = {};\n\n    for (const [key, value] of Object.entries(original)) {\n        set(result, key, value);\n    }\n\n    return result;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n/**\n * Get various information about a fraction.\n *\n * @param numerator The fraction numerator.\n * @param denominator The fraction denominator.\n */\nexport function simplifyFraction(numerator: number, denominator: number) {\n    const findGCD = (a, b) => {\n        return b ? findGCD(b, a % b) : a;\n    };\n    const gcd = findGCD(numerator, denominator);\n\n    numerator = numerator / gcd;\n    denominator = denominator / gcd;\n\n    return {\n        numerator,\n        denominator,\n        shorthand: denominator + \":\" + numerator,\n    };\n}\n","/**\n * Utilities related to strings.\n *\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport mergeWith from \"lodash/mergeWith\";\n\n/**\n * A simple, fast method of hashing a string. Similar to Java's hash function.\n * https://stackoverflow.com/a/7616484/1486603\n *\n * @param str - The string to hash.\n *\n * @returns The hash code returned.\n */\nexport function hashString(str: string): number {\n    function hashReduce(prevHash, currVal) {\n        // tslint:disable-next-line:no-bitwise\n        return (prevHash << 5) - prevHash + currVal.charCodeAt(0);\n    }\n    return str.split(\"\").reduce(hashReduce, 0);\n}\n\n/**\n * Generate a RFC4122 compliant uuid. NOTE!!! Not cryptographically secure.\n *\n * This does not use a true random source (Eg. using Math.random()).\n * To use a better source would require dropping IE in order to use the crypto module.\n */\nexport function uuidv4() {\n    return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n        const r = (Math.random() * 16) | 0,\n            v = c == \"x\" ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n}\n\n/**\n * Convert a camel case variable to a title case label.\n *\n * @param str - The string to labelize.\n * @returns Returns a new string suitable for a label.\n */\nexport function labelize(str: string): string {\n    /**\n     * $labelCode = preg_replace('`(?<![A-Z0-9])([A-Z0-9])`', ' $1', $labelCode);\n     * $labelCode = preg_replace('`([A-Z0-9])(?=[a-z])`', ' $1', $labelCode);\n     * $labelCode = preg_replace('`\\s+`', ' ', $labelCode);\n     * $labelCode = ucfirst(trim($labelCode));\n     */\n    let label = str.replace(/([^A-Z0-9])([A-Z0-9])/, \"$1 $2\");\n    label = label.replace(/([A-Z0-9])(?=[a-z])/, \" $1\");\n    label = label.replace(/[_-]/, \" \");\n    label = label.replace(/\\s+/, \" \");\n    let parts = label.split(\" \");\n    label = parts.map((s) => s.charAt(0).toLocaleUpperCase() + s.slice(1)).join(\" \");\n    return label;\n}\n\n/**\n * Hash an object into a short key, that is stable no matter what order the parameters are.\n */\nexport function stableObjectHash<T extends object>(obj: T): number {\n    // Sort the object first.\n    const ordered: any = {};\n    Object.keys(obj)\n        .sort()\n        .forEach(function (key) {\n            ordered[key] = obj[key];\n        });\n    return hashString(JSON.stringify(ordered));\n}\n\ntype CompareReturn = -1 | 0 | 1;\n\n/**\n * Utility for sorting values. Similar to the <=> operator in PHP.\n *\n * @param val1 The first value to compare.\n * @param val2 The second value to compare.\n *\n * @returns -1, 0, or 1\n */\nexport function compare<T extends string | number>(val1: T, val2: T): CompareReturn {\n    if (typeof val1 === \"string\" && typeof val2 === \"string\") {\n        return val1.localeCompare(val2) as CompareReturn;\n    } else {\n        if (val1 > val2) {\n            return 1;\n        } else if (val1 < val2) {\n            return -1;\n        }\n        return 0;\n    }\n}\n\n/**\n * Parse a string into a URL friendly format.\n *\n * Eg. Why Uber isn’t spelled Über -> why-uber-isnt-spelled-uber\n *\n * @param str The string to parse.\n */\nexport function slugify(\n    str: string,\n    options?: {\n        allowMultipleDashes?: boolean;\n    },\n): string {\n    const whiteSpaceNormalizeRegexp = options && options.allowMultipleDashes ? /[\\s]+/g : /[-\\s]+/g;\n    return str\n        .normalize(\"NFD\") // Normalize accented characters into ASCII equivalents\n        .replace(/[^\\w\\s$*_+~.()'\"\\-!:@]/g, \"\") // REmove characters that don't URL encode well\n        .trim() // Trim whitespace\n        .replace(whiteSpaceNormalizeRegexp, \"-\") // Normalize whitespace\n        .toLocaleLowerCase(); // Convert to locale aware lowercase.\n}\n\nexport function normalizeString(str: string): string {\n    return str.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\");\n}\n\n/**\n * Split a string in multiple pieces similar to String.prototype.split but ignore most acccent characters.\n *\n * This will still return pieces with accents.\n *\n * @param toSplit The string to split.\n * @param splitWith The string to split with.\n */\nexport function splitStringLoosely(toSplit: string, splitWith: string): string[] {\n    const normalizedName = normalizeString(toSplit);\n    const normalizedSplitTerm = normalizeString(splitWith);\n    const normalizedPieces = normalizedName.split(new RegExp(`(${normalizedSplitTerm})`, \"i\"));\n\n    let charactersUsed = 0;\n    return normalizedPieces.map((piece) => {\n        const start = charactersUsed;\n        charactersUsed += piece.length;\n        return toSplit.substring(start, charactersUsed);\n    });\n}\n\ninterface IMentionMatch {\n    match: string;\n    rawMatch: string;\n}\n\n/**\n * Custom matching to allow quotation marks in the matching string as well as spaces.\n * Spaces make things more complicated.\n *\n * @param subtext - The string to be tested.\n * @param shouldStartWithSpace - Should the pattern include a test for a whitespace prefix?\n * @returns Matching string if successful.  Null on failure to match.\n */\nexport function matchAtMention(\n    subtext: string,\n    shouldStartWithSpace: boolean = false,\n    requireQuotesForWhitespace: boolean = true,\n): IMentionMatch | null {\n    // Split the string at the lines to allow for a simpler regex.\n    const lines = subtext.split(\"\\n\");\n    const lastLine = lines[lines.length - 1];\n\n    // If you change this you MUST change the regex in src/scripts/__tests__/legacy.test.js !!!\n    /**\n     * Put together the non-excluded characters.\n     *\n     * @param {boolean} excludeWhiteSpace - Whether or not to exclude whitespace characters.\n     *\n     * @returns {string} A Regex string.\n     */\n    function nonExcludedCharacters(excludeWhiteSpace) {\n        let excluded =\n            \"[^\" +\n            '\"' + // Quote character\n            \"\\\\u0000-\\\\u001f\\\\u007f-\\\\u009f\" + // Control characters\n            \"\\\\u2028\"; // Line terminator\n\n        if (excludeWhiteSpace) {\n            excluded += \"\\\\s\";\n        }\n\n        excluded += \"]\";\n        return excluded;\n    }\n\n    let regexStr =\n        \"@\" + // @ Symbol triggers the match\n        \"(\" +\n        // One or more non-greedy characters that aren't excluded. Whitespace is allowed, but a starting quote is required.\n        '\"(' +\n        nonExcludedCharacters(false) +\n        '+?)\"?' +\n        \"|\" + // Or\n        // One or more non-greedy characters that aren't exluded. Whitespace may be excluded.\n        \"(\" +\n        nonExcludedCharacters(requireQuotesForWhitespace) +\n        '+?)\"?' +\n        \")\" +\n        \"(?:\\\\n|$)\"; // Newline terminates.\n\n    // Determined by at.who library\n    if (shouldStartWithSpace) {\n        regexStr = \"(?:^|\\\\s)\" + regexStr;\n    }\n    const regex = new RegExp(regexStr, \"gi\");\n    const match = regex.exec(lastLine);\n    if (match) {\n        return {\n            rawMatch: match[0],\n            match: match[2] || match[1], // Return either of the matching groups (quoted or unquoted).\n        };\n    }\n\n    // No match\n    return null;\n}\n\nconst SAFE_PROTOCOL_REGEX = /^(http:\\/\\/|https:\\/\\/|tel:|mailto:\\/\\/|\\/|#)/;\n\n/**\n * Sanitize a URL to ensure that it matches a whitelist of approved url schemes. If the url does not match one of these schemes, prepend `unsafe:` before it.\n *\n * Allowed protocols\n * - \"http://\",\n * - \"https://\",\n * - \"tel:\",\n * - \"mailto://\",\n * - \"#\"\n *\n * @param url The url to sanitize.\n */\nexport function sanitizeUrl(url: string) {\n    if (url.match(SAFE_PROTOCOL_REGEX)) {\n        return url;\n    } else {\n        return \"unsafe:\" + url;\n    }\n}\n\n/**\n * Capitalize the first character of a string.\n *\n * @param str The string to modify.\n */\nexport function capitalizeFirstLetter(str: string): string {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n/**\n * Simple utility function for waiting some duration in promise.\n *\n * @param duration The amount of time to wait.\n */\nexport function promiseTimeout(duration: number): Promise<void> {\n    return new Promise((resolve) => {\n        setTimeout(resolve, duration);\n    });\n}\n\nfunction mergeCustomizer(into: any, source: any) {\n    if (Array.isArray(into) || Array.isArray(source)) {\n        return source;\n    }\n}\n\n/**\n * Merge 2 objects, but replace arrays instead of merging them.\n */\nexport function mergeAndReplaceArrays(item1: Record<any, any>, item2: Record<any, any>) {\n    return mergeWith({}, item1, item2, mergeCustomizer);\n}\n","/**\n * Utilities related to the user's system.\n *\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nexport enum OS {\n    IOS = \"ios\",\n    ANDROID = \"android\",\n    UNKNOWN = \"unkwown\",\n}\n\n/**\n * Provide relatively rough detection of mobile OS.\n *\n * This is not even close to perfect but can be used to try and offer,\n * OS specific input elements for things like datetimes.\n */\nexport function guessOperatingSystem(): OS {\n    const userAgent = navigator.userAgent || navigator.vendor || (window as any).opera;\n\n    if (/android/i.test(userAgent)) {\n        return OS.ANDROID;\n    }\n\n    // iOS detection from: http://stackoverflow.com/a/9039885/177710\n    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {\n        return OS.IOS;\n    }\n\n    return OS.UNKNOWN;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\ninterface IClass {\n    new (): any;\n}\n\n/**\n * Determine if an instance is an instance of any of the listed classes.\n *\n * @param needle The instance.\n * @param haystack The classes to check.\n */\nexport function isInstanceOfOneOf(needle: any, haystack: IClass[]) {\n    for (const classItem of haystack) {\n        if (needle instanceof classItem) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n/**\n * Transform an array of objects and an map of objets with a given key.\n *\n * Objects that do not contain the given key are dropped.\n *\n * @param array The array to go through.\n * @param key The key to lookup.\n */\nexport function indexArrayByKey<T extends object>(\n    array: T[],\n    key: string,\n): {\n    [key: string]: T;\n} {\n    const object = {};\n    for (const item of array) {\n        if (key in item) {\n            if (!(item[key] in object)) {\n                object[item[key]] = [];\n            }\n            object[item[key]].push(item);\n        }\n    }\n    return object;\n}\n\nexport function notEmpty<TValue>(value: TValue | null | undefined): value is TValue {\n    return value !== null && value !== undefined;\n}\n\nexport function ensureString(maybeString: any) {\n    if (typeof maybeString !== \"string\") throw new TypeError(\"Expected maybeString to have type string\");\n    return maybeString;\n}\n\nexport function forceInt(value: string | null, fallback: number): number {\n    let result = Number.parseInt(value ?? \"\", 10);\n    return Number.isNaN(result) ? fallback : result;\n}\n\nexport type RecordID = string | number;\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport ReduxActions, { bindThunkAction, useReduxActions } from \"@vanilla/library/src/scripts/redux/ReduxActions\";\nimport actionCreatorFactory from \"typescript-fsa\";\nimport { IApiError } from \"@vanilla/library/src/scripts/@types/api/core\";\nimport { IRole } from \"@dashboard/roles/roleTypes\";\n\nconst createAction = actionCreatorFactory(\"@@roles\");\n\nexport class RoleActions extends ReduxActions {\n    public static getAllACs = createAction.async<{}, IRole[], IApiError>(\"GET_ALL\");\n\n    public getAllRoles = () => {\n        const thunk = bindThunkAction(RoleActions.getAllACs, async () => {\n            const response = await this.api.get(`/roles`, { params: { limit: 500 } });\n            return response.data;\n        })({});\n\n        return this.dispatch(thunk);\n    };\n}\n\nexport function useRoleActions() {\n    return useReduxActions(RoleActions);\n}\n","var map = {\n\t\"./en-SG\": 83,\n\t\"./en-SG.js\": 83,\n\t\"./en-au\": 84,\n\t\"./en-au.js\": 84,\n\t\"./en-ca\": 85,\n\t\"./en-ca.js\": 85,\n\t\"./en-gb\": 86,\n\t\"./en-gb.js\": 86,\n\t\"./en-ie\": 87,\n\t\"./en-ie.js\": 87,\n\t\"./en-il\": 88,\n\t\"./en-il.js\": 88,\n\t\"./en-nz\": 89,\n\t\"./en-nz.js\": 89\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 147;","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { produce } from \"immer\";\nimport { reducerWithInitialState } from \"typescript-fsa-reducers\";\nimport { IRole } from \"@dashboard/roles/roleTypes\";\nimport { ILoadable, LoadStatus } from \"@vanilla/library/src/scripts/@types/api/core\";\nimport { RoleActions } from \"@dashboard/roles/RoleActions\";\n\nexport interface IRoleState {\n    rolesByID: ILoadable<Record<number, IRole>>;\n}\n\nexport interface IRoleStoreState {\n    roles: IRoleState;\n}\n\nexport const INITIAL_ROLE_STATE: IRoleState = {\n    rolesByID: {\n        status: LoadStatus.PENDING,\n    },\n};\n\nexport const roleReducer = produce(\n    reducerWithInitialState<IRoleState>(INITIAL_ROLE_STATE)\n        .case(RoleActions.getAllACs.started, (nextState, action) => {\n            nextState.rolesByID = {\n                status: LoadStatus.LOADING,\n            };\n            return nextState;\n        })\n        .case(RoleActions.getAllACs.done, (nextState, payload) => {\n            const rolesByID: Record<number, IRole> = {};\n            payload.result.forEach((role) => {\n                rolesByID[role.roleID] = role;\n            });\n            nextState.rolesByID = {\n                status: LoadStatus.SUCCESS,\n                data: rolesByID,\n            };\n            return nextState;\n        })\n        .case(RoleActions.getAllACs.failed, (nextState, action) => {\n            nextState.rolesByID.status = LoadStatus.ERROR;\n            nextState.rolesByID.error = action.error;\n            return nextState;\n        }),\n);\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nexport interface ILocale {\n    localeID: string;\n    localeKey: string;\n    regionalKey: string;\n    displayNames: {\n        [localeKey: string]: string;\n    };\n}\n\nlet currentLocale = \"en\";\nlet localeStore: ILocale[] = [];\nlet callbacks: Array<() => void> = [];\n\n/**\n * Get the available locales.\n */\nexport function getLocales(): ILocale[] {\n    return localeStore;\n}\n\n/**\n * Register a handler for if the locales change.\n * @param callback\n */\nexport function onLocaleChange(callback: () => void) {\n    callbacks.push(callback);\n}\n\n/**\n * Set the current locale.\n */\nexport function setCurrentLocale(localeKey: string) {\n    currentLocale = localeKey;\n    callbacks.forEach(callback => callback());\n}\n\n/**\n * Get the current locale.\n */\nexport function getCurrentLocale() {\n    return currentLocale;\n}\n\n/**\n * Get the current locale in format accepted by Javascript localization functions.\n *\n * PHP canonicalized locales use `_` for the regional separator.\n * Javascript uses `-`.\n */\nexport function getJSLocaleKey() {\n    return currentLocale.replace(\"_\", \"-\");\n}\n\n/**\n * Load a group of locales.\n */\nexport function loadLocales(locales: ILocale[]) {\n    localeStore = [...localeStore, ...locales];\n    callbacks.forEach(callback => callback());\n}\n\n/**\n * Clear the loaded locales.\n */\nexport function clearLocales() {\n    localeStore = [];\n    callbacks.forEach(callback => callback());\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React, { useState, useContext, useEffect } from \"react\";\nimport { ILocale, getLocales, onLocaleChange, getCurrentLocale } from \"./localeStore\";\nimport { logWarning } from \"@vanilla/utils\";\n\nconst LocaleContext = React.createContext<{\n    locales: ILocale[];\n    currentLocale: string | null;\n}>({\n    locales: [],\n    currentLocale: null,\n});\n\nexport function LocaleProvider(props: { children?: React.ReactNode }) {\n    const [locales, setLocales] = useState(getLocales());\n    const [currentLocale, setCurrentLocale] = useState(getCurrentLocale());\n\n    if (!currentLocale) {\n        logWarning(\"No locale loaded for <LocaleProvider />\");\n    }\n\n    useEffect(() => {\n        setLocales(getLocales());\n        setCurrentLocale(getCurrentLocale());\n\n        onLocaleChange(() => {\n            setLocales(getLocales());\n            setCurrentLocale(getCurrentLocale());\n        });\n    }, [setLocales, setCurrentLocale]);\n\n    return (\n        <LocaleContext.Provider\n            value={{\n                locales,\n                currentLocale,\n            }}\n        >\n            {props.children}\n        </LocaleContext.Provider>\n    );\n}\n\nexport function useLocaleInfo() {\n    return useContext(LocaleContext);\n}\n","import { logError, logWarning } from \"@vanilla/utils\";\n\n/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\ninterface ITranslations {\n    [key: string]: string;\n}\n\nlet translationStore: ITranslations | null = null;\n\nlet internalTranslationDebugValue = false;\n\n/**\n * Get or set the debug flag.\n *\n * @param newValue - The new value of debug.\n * @returns the current debug setting.\n */\nexport function translationDebug(newValue?: boolean): boolean {\n    if (newValue !== undefined) {\n        internalTranslationDebugValue = newValue;\n    }\n\n    return internalTranslationDebugValue;\n}\n\n/**\n * Load a set of key value pairs as translation resources.\n */\nexport function loadTranslations(translations: ITranslations) {\n    translationStore = { ...translations };\n}\n\n/**\n * Clear all translation resources.\n */\nexport function clearTranslations() {\n    translationStore = null;\n}\n\n/**\n * Translate a string into the current locale.\n *\n * @param str - The string to translate.\n * @param defaultTranslation - The default translation to use.\n *\n * @returns Returns the translation or the default.\n */\nexport function translate(str: string, defaultTranslation?: string): string {\n    // Codes that begin with @ are considered literals.\n    if (str.substr(0, 1) === \"@\") {\n        return str.substr(1);\n    }\n\n    const fallback = defaultTranslation !== undefined ? defaultTranslation : str;\n\n    if (!translationStore) {\n        // Test environment allows top level static initialization.\n        const message = `Attempted to translate a value '${str}' before the translation store was initialized.`;\n        switch (process.env.NODE_ENV) {\n            case \"production\":\n                logWarning(message);\n                break;\n            case \"development\":\n                throw new Error(message + \" Don't use t() in the top level of a file or a static property.\");\n            case \"test\":\n                // Tests (like storybook and unit testing) don't need to actually bootstrap a full translation store all the time.\n                break;\n        }\n        return fallback;\n    }\n\n    if (translationStore[str] !== undefined) {\n        return translationStore[str];\n    }\n\n    if (translationDebug()) {\n        return \"☢️☢️☢️\" + fallback + \"☢️☢️☢️\";\n    } else {\n        return fallback;\n    }\n}\n\n/**\n * The t function is an alias for translate.\n */\nexport const t = translate;\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { logError, RecordID } from \"@vanilla/utils\";\n\nexport interface IContentTranslatorProps {\n    isLoading?: boolean;\n    isFullScreen?: boolean;\n    properties: ITranslationProperty[];\n    resource: string;\n    title: string;\n    sourceLocale?: string | null;\n    activeLocale?: string | null; // for organizecategories\n    afterSave?: () => void;\n}\n\n// Subtypes\nexport enum TranslationPropertyType {\n    TEXT = \"text\",\n    TEXT_MULTILINE = \"\",\n}\n\nexport interface ITranslationProperty {\n    recordType: string; // Ex. knowledgeCategory\n    recordID?: RecordID; // Ex. 425\n    recordKey?: string; // Ex. Garden.Description\n    sourceText: string; // Ex. \"Howdy Stranger\"\n    propertyName: string; // Ex. name\n    propertyValidation: ITranslationPropertyValidation;\n    propertyType: TranslationPropertyType;\n}\n\nexport interface ITranslationPropertyValidation {\n    minLength?: number;\n    maxLength?: number;\n}\n\nexport const NullContentTranslator: React.FC<IContentTranslatorProps> = (props) => {\n    logError(\"Rendering a Null Content translator. Be sure to check `shouldDisplay` before rendering.\");\n    return null;\n};\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React, { useContext } from \"react\";\nimport { IContentTranslatorProps, NullContentTranslator } from \"./ContentTranslator\";\nimport { useLocaleInfo } from \"./LocaleProvider\";\n\ninterface IContentTranslator {\n    shouldDisplay: boolean;\n    Translator: React.ComponentType<IContentTranslatorProps>;\n}\n\nconst context = React.createContext<IContentTranslator>({\n    shouldDisplay: false,\n    Translator: NullContentTranslator,\n});\n\nlet _TranslationComponent: React.ComponentType<IContentTranslatorProps> | null = null;\n\n/**\n * Provider of the translation component.\n */\nexport const ContentTranslationProvider = (props: { children: React.ReactNode }) => {\n    const { locales } = useLocaleInfo();\n\n    return (\n        <context.Provider\n            value={{\n                shouldDisplay: _TranslationComponent !== null && locales.length > 1,\n                Translator: _TranslationComponent !== null ? _TranslationComponent : NullContentTranslator,\n            }}\n        >\n            {props.children}\n        </context.Provider>\n    );\n};\n\nContentTranslationProvider.setTranslator = (Translator: React.ComponentType<IContentTranslatorProps>) => {\n    _TranslationComponent = Translator;\n};\n\nexport function useContentTranslator(): IContentTranslator {\n    return useContext(context);\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n/**\n * Get the form data out of a form element.\n *\n * @param formElement - The element to get the data out of.\n *\n * @returns {Object}\n */\nexport function getFormData(formElement: Node | null) {\n    if (!(formElement instanceof HTMLFormElement)) {\n        return {};\n    }\n\n    const data = new FormData(formElement) as any;\n    const result = {};\n\n    data.forEach((key, value) => {\n        result[key] = value;\n    });\n\n    return result;\n}\n\n/**\n * Toggle any attribute on an element.\n *\n * @param element - The element to toggle on.\n * @param attribute - The attribute to toggle.\n */\nexport function toggleAttribute(element: Element, attribute: string) {\n    const newValue = element.getAttribute(attribute) === \"false\";\n    element.setAttribute(attribute, newValue ? \"true\" : \"false\");\n}\n\nconst dataMap = new WeakMap();\n\n/**\n * Set a piece of data specific to a DOM Element. Similar to `$.data`.\n *\n * @param element - The DOM Element to assosciate the data with.\n * @param key - The key to assosciate the data with.\n * @param value - The value to store.\n */\nexport function setData(element: Element, key: string, value: any) {\n    const initialValue = dataMap.has(element) ? dataMap.get(element) : {};\n    initialValue[key] = value;\n\n    dataMap.set(element, initialValue);\n}\n\n/**\n * Get a piece of data specific to a DOM Element. Similar to `$.data`.\n *\n * @param element - The DOM Element to lookup.\n * @param key - The key to lookup.\n * @param defaultValue - A value to use if the element or key aren't found.\n */\nexport function getData(element: Element, key: string, defaultValue?: any) {\n    if (dataMap.has(element) && dataMap.get(element)[key]) {\n        return dataMap.get(element)[key];\n    }\n\n    const attributeString = `data-${key}`;\n\n    if (element.hasAttribute(attributeString)) {\n        return element.getAttribute(attributeString);\n    }\n\n    return defaultValue;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport twemoji from \"twemoji\";\n\nlet emojiSupportedCache: boolean | null = null;\n\n/**\n * Determine if the browser/OS combo has support for real unicode emojis.\n */\nexport function isEmojiSupported() {\n    if (emojiSupportedCache !== null) {\n        return emojiSupportedCache;\n    }\n\n    if (process.env.NODE_ENV !== \"test\") {\n        // Test environment\n        const canvas = document.createElement(\"canvas\");\n        if (canvas.getContext && canvas.getContext(\"2d\")) {\n            const ctx = document.createElement(\"canvas\").getContext(\"2d\");\n            if (ctx) {\n                ctx.fillText(\"😗\", -2, 4);\n                emojiSupportedCache = ctx.getImageData(0, 0, 1, 1).data[3] > 0;\n            } else {\n                emojiSupportedCache = false;\n            }\n        } else {\n            emojiSupportedCache = false;\n        }\n    } else {\n        emojiSupportedCache = true;\n    }\n\n    return emojiSupportedCache;\n}\n\nconst emojiOptions = {\n    className: \"fallBackEmoji\",\n    size: \"72x72\",\n};\n\n/**\n * Returns either native emoji or fallback image\n *\n * @param stringOrNode - A DOM Node or string to convert.\n */\nexport function convertToSafeEmojiCharacters(stringOrNode: string | Node) {\n    if (isEmojiSupported()) {\n        return stringOrNode;\n    }\n    return twemoji.parse(stringOrNode, emojiOptions);\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n/**\n * Register an keyboard listener for the escape key.\n */\nexport class EscapeListener {\n    /**\n     * @param root - The element to watch for the escape listener in.\n     * @param returnElement - The element to return to when escape is pressed.\n     * @param callback\n     */\n    public constructor(\n        private root: HTMLElement,\n        private returnElement?: HTMLElement,\n        private callback?: (event: KeyboardEvent) => void,\n    ) {}\n\n    /**\n     * Start the listeners.\n     */\n    public start = () => {\n        this.root.addEventListener(\"keydown\", this.keydownListener);\n    };\n\n    /**\n     * Stop the listeners.\n     */\n    public stop = () => {\n        this.root.removeEventListener(\"keydown\", this.keydownListener);\n    };\n\n    /**\n     * Handler that checks for the key of an keyboard event and:\n     *\n     * - Returns focous to the element from the constructor.\n     * - Calls the optional callback.\n     */\n    private keydownListener = (event: KeyboardEvent) => {\n        if (event.key === \"Escape\") {\n            if (this.root.contains(document.activeElement)) {\n                event.preventDefault();\n                this.returnElement && this.returnElement.focus();\n                this.callback && this.callback(event);\n            }\n        }\n    };\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { hashString } from \"@vanilla/utils\";\n\nconst delegatedEventListeners = {};\n\n/**\n * Create an event listener using event delegation.\n *\n * @param eventName - The Event to listen for.\n * @param filterSelector - A CSS selector to match against.\n * @param callback - The callback function. This gets passed the fired event.\n * @param scopeSelector - And element to scope the event listener to.\n *\n * @returns The hash of the event. Save this to use removeDelegatedEvent().\n */\nexport function delegateEvent(\n    eventName: string,\n    filterSelector: string,\n    callback: (event: Event, triggeringElement: HTMLElement) => boolean | void,\n    scopeSelector?: string | HTMLElement,\n): string {\n    let functionKey = eventName + filterSelector + callback.toString();\n\n    let scope;\n\n    if (typeof scopeSelector === \"string\") {\n        scope = document.querySelector(scopeSelector);\n\n        if (!scope) {\n            throw new Error(`Unable to find element in the document for scopeSelector: ${scopeSelector}`);\n        } else {\n            functionKey += scopeSelector;\n        }\n    } else if (scopeSelector instanceof HTMLElement) {\n        scope = scopeSelector;\n    } else {\n        scope = document;\n    }\n\n    const eventHash = hashString(functionKey).toString();\n\n    if (!Object.keys(delegatedEventListeners).includes(eventHash)) {\n        const wrappedCallback = event => {\n            // Get the nearest DOMNode that matches the given selector.\n            const match = filterSelector ? event.target.closest(filterSelector) : event.target;\n\n            if (match) {\n                // Call the callback with the matching element as the context.\n                return callback.call(match, event, match);\n            }\n        };\n\n        scope.addEventListener(eventName, wrappedCallback);\n        delegatedEventListeners[eventHash] = {\n            scope,\n            eventName,\n            wrappedCallback,\n        };\n    }\n\n    return eventHash;\n}\n\n/**\n * Remove a delegated event listener.\n *\n * @param eventHash - The event hash passed from delegateEvent().\n */\nexport function removeDelegatedEvent(eventHash: string) {\n    if (delegatedEventListeners[eventHash]) {\n        const { scope, eventName, wrappedCallback } = delegatedEventListeners[eventHash];\n        scope.removeEventListener(eventName, wrappedCallback);\n        delete delegatedEventListeners[eventHash];\n    }\n}\n\n/**\n * Remove all delegated event listeners that have been registered.\n */\nexport function removeAllDelegatedEvents() {\n    Object.keys(delegatedEventListeners).forEach(key => {\n        removeDelegatedEvent(key);\n    });\n}\n\n/**\n * Handler for files being dragged and dropped.\n *\n * @param event - https://developer.mozilla.org/en-US/docs/Web/API/DragEvent\n */\nexport function getDraggedFile(event: DragEvent): FileList | undefined {\n    if (event.dataTransfer && event.dataTransfer.files && event.dataTransfer.files.length) {\n        event.preventDefault();\n\n        return event.dataTransfer.files;\n    }\n}\n\n/**\n * Handler for files being pasted.\n *\n * @param event - https://developer.mozilla.org/en-US/docs/Web/API/DragEvent\n */\nexport function getPastedFile(event: ClipboardEvent): File | undefined | null {\n    if (event.clipboardData && event.clipboardData.items && event.clipboardData.items.length) {\n        const files = Array.from(event.clipboardData.items)\n            .map((item: any) => (item.getAsFile ? item.getAsFile() : null))\n            .filter(Boolean);\n\n        if (files.length > 0) {\n            event.preventDefault();\n            // Currently only 1 file is supported.\n            const mainFile = files[0];\n            return mainFile;\n        }\n    }\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n/**\n * Register a callback for focusin and focusin out events. The main improvement here over registering\n * the listeners yourself is that the events fire for the whole tree as 1 item instead of as\n * individual notes.\n *\n * This is particularly useful when you want to track focus leaving or enterring a component\n * without caring about the individual contents inside.\n */\nexport class FocusWatcher {\n    /**\n     * @param watchedNode - The watched dom node.\n     * @param callback - A callback for when the tree focuses and blurs.\n     */\n    public constructor(private watchedNode: Element, private changeHandler: (hasFocus: boolean) => void) {}\n\n    /**\n     * Register the event listeners from this class.\n     */\n    public start = () => {\n        this.watchedNode.addEventListener(\"focusout\", this.handleFocusOut, true);\n        this.watchedNode.addEventListener(\"focusin\", this.handleFocusIn, true);\n        document.addEventListener(\"click\", this.handleClick);\n    };\n\n    /**\n     * Remove the event listeners from this class.\n     */\n    public stop = () => {\n        this.watchedNode.removeEventListener(\"focusout\", this.handleFocusOut, true);\n        this.watchedNode.removeEventListener(\"focusin\", this.handleFocusIn, true);\n        document.removeEventListener(\"click\", this.handleClick);\n    };\n\n    /**\n     * Handle when an element loses focus.\n     */\n    private handleFocusOut = (event: FocusEvent) => {\n        this.checkDomTreeHasFocus(event, this.changeHandler);\n    };\n\n    /**\n     * Handle an element gaining focus.\n     */\n    private handleFocusIn = (event: FocusEvent) => {\n        this.checkDomTreeHasFocus(event, this.changeHandler);\n    };\n\n    /**\n     * Handle an element being clicked.\n     */\n    private handleClick = (event: MouseEvent) => {\n        const triggeringElement = event.target as Element;\n        const wasClicked = this.checkDomTreeWasClicked(triggeringElement);\n        if (!wasClicked) {\n            this.changeHandler(false);\n        }\n    };\n\n    /**\n     * Determine whether or not our DOM tree was clicked.\n     */\n    private checkDomTreeWasClicked(clickedElement: Element) {\n        return (\n            this.watchedNode &&\n            clickedElement &&\n            (this.watchedNode.contains(clickedElement as Element) || this.watchedNode === clickedElement)\n        );\n    }\n\n    /**\n     * Determine if the currently focused element is somewhere inside of (or the same as)\n     * a given Element.\n     *\n     * @param watchedNode - The watched node to look in.\n     */\n    private checkDomTreeHasFocus(event: FocusEvent, callback: (hasFocus: boolean) => void) {\n        setTimeout(() => {\n            const possibleTargets = [\n                // NEEDS TO COME FIRST, because safari will populate relatedTarget on focusin, and its not what we're looking for.\n                document.activeElement, // IE11, Safari.\n                event.relatedTarget as Element, // Chrome (The actual standard)\n                (event as any).explicitOriginalTarget, // Firefox\n            ];\n\n            let activeElement = null;\n            for (const target of possibleTargets) {\n                if (target && target !== document.body) {\n                    activeElement = target;\n                    break;\n                }\n            }\n\n            if (activeElement !== null) {\n                const isWatchedInBody = document.body.contains(this.watchedNode);\n                const isFocusedInBody = document.body.contains(activeElement);\n                const isModal = Boolean(document.getElementById(\"modals\")?.contains(activeElement));\n                const hasFocus = Boolean(\n                    this.watchedNode &&\n                        activeElement &&\n                        (activeElement === this.watchedNode || this.watchedNode.contains(activeElement)),\n                );\n\n                // We will only invalidate based on something actually getting focus.\n                // Make sure we are still mounted before calling this.\n                // It could happen that our flyout is unmounted in between the setTimeout call.\n                // We might have focused on a modal which can't be in the watched tree.\n                if (isWatchedInBody && isFocusedInBody) {\n                    callback(hasFocus || isModal);\n                }\n            }\n        }, 0);\n    }\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n/**\n * Use the browser's built-in functionality to quickly and safely escape a string.\n *\n * @param str - The string to escape.\n *\n * @returns Escaped HTML.\n */\nexport function escapeHTML(str: string): string {\n    const div = document.createElement(\"div\");\n    div.appendChild(document.createTextNode(str));\n    return div.innerHTML;\n}\n\n/**\n * Use the browser's built-in functionality to quickly unescape a string.\n * UNSAFE with unsafe strings; only use on previously-escaped ones!\n *\n * @param escapedString - A previously escaped string.\n *\n * @returns The unescaped string.\n */\nexport function unescapeHTML(escapedString: string): string {\n    const div = document.createElement(\"div\");\n    div.innerHTML = escapedString;\n    const child = div.childNodes[0];\n    return child && child.nodeValue ? child.nodeValue : \"\";\n}\n\n/**\n * Determine if the browser is escaping the inner contents of our <noscript /> browser.\n */\nexport function browserEscapesNoScript(): boolean {\n    const ns = document.createElement(\"noscript\");\n    ns.innerHTML = \"<test></test>\";\n    document.body.append(ns);\n    const result = ns.innerHTML.startsWith(\"&lt;\");\n    ns.remove();\n    return result;\n}\n\n/**\n * Get an HTML element from a CSS selector or DOM Node.\n *\n * @param selectorOrElement - A CSS selector or an HTML element.\n *\n * @throws If no element was found.\n * @returns An HTMLElement no matter what.\n */\nexport function ensureHtmlElement(selectorOrElement: string | Node | null): HTMLElement {\n    if (typeof selectorOrElement === \"string\") {\n        selectorOrElement = document.querySelector(selectorOrElement);\n    }\n\n    if (!(selectorOrElement instanceof HTMLElement)) {\n        throw new Error(`HTMLElement could not be found for ${selectorOrElement}.`);\n    }\n\n    return selectorOrElement;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n// A weakmap so we can store multiple load callbacks per script.\nconst loadEventCallbacks: WeakMap<Node, Array<(event) => void>> = new WeakMap();\nconst rejectionCache: Map<string, Error> = new Map();\n\n/**\n * Dynamically load a javascript file.\n */\nexport function ensureScript(scriptUrl: string): Promise<void> {\n    return new Promise((resolve, reject) => {\n        const existingScript: HTMLScriptElement | null = document.querySelector(`script[src='${scriptUrl}']`);\n        if (rejectionCache.has(scriptUrl)) {\n            reject(rejectionCache.get(scriptUrl));\n        }\n        if (existingScript && loadEventCallbacks.has(existingScript)) {\n            // Add another resolveCallback into the weakmap.\n            const callbacks = loadEventCallbacks.get(existingScript);\n            callbacks && callbacks.push(resolve);\n        } else {\n            // The script doesn't exist. Lets create it.\n            const head = document.getElementsByTagName(\"head\")[0];\n            const script = document.createElement(\"script\");\n            script.type = \"text/javascript\";\n            script.src = scriptUrl;\n            script.onerror = (event: ErrorEvent) => {\n                const error = new Error(\"Failed to load a required embed script\");\n                rejectionCache.set(scriptUrl, error);\n                reject(error);\n            };\n\n            const timeout = setTimeout(() => {\n                const error = new Error(`Loading of the script ${scriptUrl} has timed out.`);\n                rejectionCache.set(scriptUrl, error);\n                reject(error);\n            }, 10000);\n\n            loadEventCallbacks.set(script, [resolve]);\n\n            script.onload = event => {\n                clearTimeout(timeout);\n                const callbacks = loadEventCallbacks.get(script);\n                callbacks && callbacks.forEach(callback => callback(event));\n                loadEventCallbacks.delete(script);\n            };\n\n            head.appendChild(script);\n        }\n    });\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { browserEscapesNoScript, unescapeHTML } from \"./sanitization\";\n\n/**\n * Prepare an element and it's contents for use in a shadow root.\n *\n * @param element\n * @param cloneElement - If true, clone the element into a `newElementTag`. Preserves CSS classes and IDs.\n *      Particularly useful for when the initial content is inside of a <noscript /> tag.\n * @param newElementTag\n */\nexport function prepareShadowRoot(\n    element: HTMLElement,\n    cloneElement: boolean = false,\n    newElementTag = \"div\",\n): HTMLElement {\n    let html = element.innerHTML;\n    // This is likely a noscript tag.\n    if (browserEscapesNoScript() || html.trim().startsWith(\"&lt;\")) {\n        html = unescapeHTML(html);\n    }\n    // Safari escapes the contents of the noscript.\n    if (cloneElement) {\n        const newElement = document.createElement(newElementTag);\n\n        // Clone various attributes.\n        newElement.classList.value = element.classList.value;\n        newElement.id = element.id;\n\n        // Insert the element & remove the old old.\n        element.parentNode!.insertBefore(newElement, element);\n        element.remove();\n        element = newElement;\n    } else {\n        // If we aren't making a new real root, we need to empty it out.\n        // Otherwise we'll have duplicate contents.\n        element.innerHTML = \"\";\n    }\n\n    const shadowHeader = element.attachShadow({ mode: \"open\" });\n    shadowHeader.innerHTML = html;\n    return element;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport tabbable from \"tabbable\";\nimport { logError } from \"@vanilla/utils\";\n\n/**\n * A class for handling tabbing inside of a container with various exclusions.\n *\n * The goal is here is to be able to programatically implement various tabbing behaviours\n * required for accessibility.\n */\nexport class TabHandler {\n    private tabbableElements: HTMLElement[];\n\n    /**\n     * Determine if an element is tabbable.\n     */\n    public static isTabbable(element: Node) {\n        const children = tabbable(element.parentNode);\n        return children.includes(element);\n    }\n\n    /**\n     * Construct the handler. Don't be afraid to construct multiple of these.\n     *\n     * The elements in a particular TabHandler are very moment specific.\n     * If the DOM changes underneath it it will likely no longer be valid.\n     *\n     * @param root - The root element to look in.\n     * @param excludedElements - Elements to ignore.\n     * @param excludedRoots - These element's children will be ignored.\n     */\n    public constructor(\n        root: Element = document.documentElement!,\n        private excludedElements: Element[] = [],\n        private excludedRoots: Element[] = [],\n    ) {\n        this.tabbableElements = tabbable(root);\n    }\n\n    /**\n     * Get the next tabbable item within a given tabindex.\n     *\n     * WARNING: Performance can be poor if you pass many excluded roots and do not\n     * sufficiently narrow the tree your are looking in.\n     *\n     * @param from - The currently focused element.\n     * @param reverse - True to get the previous element instead.\n     * @param allowLooping - Whether or not the focus should loop around from beginning <-> end.\n     */\n    public getNext(\n        from: Element | null = document.activeElement,\n        reverse: boolean = false,\n        allowLooping: boolean = true,\n    ): HTMLElement | null {\n        if (!(from instanceof HTMLElement)) {\n            logError(\"Unable to tab to next element, `fromElement` given is not valid: \", from);\n            return null;\n        }\n        const tabbables = this.tabbableElements.filter(this.createExcludeFilterWithExemption(from));\n        const currentTabIndex = tabbables.indexOf(from);\n\n        if (currentTabIndex < 0) {\n            return null;\n        }\n\n        let targetIndex = reverse ? currentTabIndex - 1 : currentTabIndex + 1;\n\n        if (allowLooping) {\n            // Loop over the beginning and ends\n            if (targetIndex < 0) {\n                targetIndex = tabbables.length - 1;\n            } else if (targetIndex >= tabbables.length) {\n                targetIndex = 0;\n            }\n        }\n\n        return tabbables[targetIndex] || null;\n    }\n\n    /**\n     * Get all.\n     */\n    public getAll(from: Element | null = document.activeElement) {\n        if (!(from instanceof HTMLElement)) {\n            logError(\"Unable to tab to next element, `fromElement` given is not valid: \", from);\n            return null;\n        }\n        return this.tabbableElements.filter(this.createExcludeFilterWithExemption(from));\n    }\n\n    /**\n     * Get the first focusable element.\n     */\n    public getInitial(): HTMLElement | null {\n        const tabbables = this.tabbableElements.filter(this.filterAllExcluded);\n        if (tabbables.length > 0) {\n            return tabbables[0];\n        } else {\n            return null;\n        }\n    }\n    /**\n     * Get the last focusable element.\n     */\n    public getLast(): HTMLElement | null {\n        const tabbables = this.tabbableElements.filter(this.filterAllExcluded);\n        if (tabbables.length > 0) {\n            return tabbables[tabbables.length - 1];\n        } else {\n            return null;\n        }\n    }\n\n    /**\n     * Filter out all excluded elements. Allows 1 element and its parents to be exempted.\n     *\n     * The exemption is necessary so we can find our place\n     * if the focus is already in an item that we are trying to exclude.\n     *\n     * @returns A filter for use with [].filter()\n     */\n    private createExcludeFilterWithExemption = (exemption: Element) => {\n        return (elementToFilter: Element): boolean => {\n            const elementIsActiveOrChildOfActive = exemption === elementToFilter || elementToFilter.contains(exemption);\n\n            if (!elementIsActiveOrChildOfActive) {\n                if (this.excludedElements.includes(elementToFilter)) {\n                    return false;\n                }\n                for (const excludedRoot of this.excludedRoots) {\n                    if (excludedRoot !== elementToFilter && excludedRoot.contains(elementToFilter)) {\n                        return false;\n                    }\n                }\n            }\n\n            return true;\n        };\n    };\n\n    /**\n     * A filter for use with [].filter().\n     *\n     * Filters out all excluded elements and roots.\n     */\n    private filterAllExcluded = (elementToFilter: Element): boolean => {\n        if (this.excludedElements.includes(elementToFilter)) {\n            return false;\n        }\n        for (const excludedRoot of this.excludedRoots) {\n            if (excludedRoot !== elementToFilter && excludedRoot.contains(elementToFilter)) {\n                return false;\n            }\n        }\n\n        return true;\n    };\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\n// Some polyfills\nimport \"focus-visible\";\nimport smoothscroll from \"smoothscroll-polyfill\";\n\nsmoothscroll.polyfill();\n\nexport * from \"./domData\";\nexport * from \"./emoji\";\nexport * from \"./EscapeListener\";\nexport * from \"./events\";\nexport * from \"./FocusWatcher\";\nexport * from \"./sanitization\";\nexport * from \"./scripts\";\nexport * from \"./shadowDom\";\nexport * from \"./TabHandler\";\nexport * from \"./visibility\";\n","/**\n * @author Adam Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\n\ninterface IProps {\n    duration: number;\n    onHover: React.MouseEventHandler | undefined;\n    once?: boolean;\n    children: (providedProps: IProvidedProps) => React.ReactNode;\n}\n\ninterface IProvidedProps {\n    onMouseEnter: React.MouseEventHandler;\n    onMouseLeave: React.MouseEventHandler;\n}\n\n/**\n * Component with render props for handling a hover after a certain duration.\n *\n * Simply spread the provided props over the element you want to track the hover of.\n *\n * @example\n * <Hoverable duration={250} onHover={myCallback}>\n *     {providedProps => {\n *          <div {...providedProps} className=\"someClass\">\n *              // Some deeply neested child.\n *          </div>\n *     }}\n * </Hoverable>\n */\nexport class Hoverable extends React.Component<IProps> {\n    public static defaultProps = {\n        once: true,\n    };\n\n    /**\n     * @inheritdoc\n     */\n    public render(): React.ReactNode {\n        return this.props.children({\n            onMouseEnter: this.mouseEnterHandler,\n            onMouseLeave: this.mouseLeaveHandler,\n        });\n    }\n\n    /**\n     * @inheritdoc\n     */\n    public componentWillUnmount() {\n        this.dismissTimeout();\n    }\n\n    private hoverTimeout: NodeJS.Timeout;\n    private hasExecuted = false;\n\n    /**\n     * Handle the hover event by checking if we've already called ourselves then calling the passed callback.\n     */\n    private handleHover = (event: React.MouseEvent) => {\n        if (this.hasExecuted && this.props.once) {\n            return;\n        }\n\n        this.hasExecuted = true;\n        if (this.props.onHover) {\n            this.props.onHover(event);\n        }\n    };\n\n    /**\n     * Set a timeout when the mouse enters. If the timeout is not removed we have a hover.\n     */\n    private mouseEnterHandler = (event: React.MouseEvent) => {\n        this.hoverTimeout = setTimeout(() => {\n            this.handleHover(event);\n        }, this.props.duration);\n    };\n\n    /**\n     * Remove the timeout for the hover so it doesn't execute again (or at all).\n     */\n    private mouseLeaveHandler = (event: React.MouseEvent) => {\n        this.dismissTimeout();\n    };\n\n    /**\n     * Cleanup timeouts and properties to reset.\n     */\n    private dismissTimeout() {\n        this.hasExecuted = false;\n        if (this.hoverTimeout) {\n            clearTimeout(this.hoverTimeout);\n        }\n    }\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { RefObject, useState, useLayoutEffect } from \"react\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport debounce from \"lodash/debounce\";\nimport { stableObjectHash } from \"@vanilla/utils\";\n\n// DOMRectReadOnly.fromRect()\nconst EMPTY_RECT: DOMRect = {\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    toJSON: () => \"\",\n};\n\n/**\n * Utility hook for measuring a dom element.\n * Will return back measurements as a bounding rectangle for the element contained in a ref.\n *\n * @param ref The ref to measure.\n * @param adjustForScrollOffset If set, y values will be adjusted for the current scroll offset.\n * @param watchRef Used to trigger a remeasure if the ref changes.\n */\nexport function useMeasure(\n    ref: RefObject<HTMLElement | null>,\n    adjustForScrollOffset: boolean = false,\n    watchRef: boolean = false,\n) {\n    const [bounds, setContentRect] = useState<DOMRect>(EMPTY_RECT);\n    const refWatch = watchRef ? ref.current : ref;\n    useLayoutEffect(() => {\n        let animationFrameId: number | null = null;\n\n        const measure = () => {\n            animationFrameId = window.requestAnimationFrame(() => {\n                if (!ref.current) {\n                    setContentRect(EMPTY_RECT);\n                    return;\n                }\n                let rect = ref.current.getBoundingClientRect();\n\n                if (adjustForScrollOffset) {\n                    rect = {\n                        ...rect,\n                        y: rect.y + window.scrollY,\n                        top: rect.top + window.scrollY,\n                        bottom: rect.bottom + window.scrollY,\n                        width: rect.width,\n                        height: rect.height,\n                        right: rect.right,\n                        left: rect.left,\n                    };\n                }\n\n                rect.toJSON = () => {\n                    return JSON.stringify({\n                        y: rect.y,\n                        top: rect.top,\n                        bottom: rect.bottom,\n                        width: rect.width,\n                        height: rect.height,\n                        right: rect.right,\n                        left: rect.left,\n                    });\n                };\n\n                setContentRect(rect);\n            });\n        };\n\n        const resizeListener = debounce(() => {\n            measure();\n        }, 100);\n        window.addEventListener(\"resize\", resizeListener);\n\n        const ro = new ResizeObserver(measure);\n        if (ref.current) {\n            ro.observe(ref.current);\n        } else {\n            setContentRect(EMPTY_RECT);\n        }\n\n        return () => {\n            window.cancelAnimationFrame(animationFrameId!);\n            ro.disconnect();\n            resizeListener.cancel();\n            window.removeEventListener(\"resize\", resizeListener);\n            setContentRect(EMPTY_RECT);\n        };\n    }, [adjustForScrollOffset, refWatch, ref]);\n\n    return bounds;\n}\n","/**\n * @author Adam Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2020 Vanilla Forums Inc.\n * @license gpl-2.0-only\n */\n\nimport React, { useLayoutEffect, useRef } from \"react\";\n\nexport function useDomNodeAttachment(domNodes?: Node[]): React.RefObject<any> {\n    const ref = useRef<HTMLElement | null>();\n\n    useLayoutEffect(() => {\n        if (domNodes && ref.current) {\n            domNodes.forEach((node) => {\n                ref.current?.appendChild(node);\n            });\n        }\n    }, [domNodes]);\n\n    return ref;\n}\n\ninterface IProps extends React.HTMLAttributes<HTMLDivElement> {\n    nodes: Node[];\n}\n\nexport function DomNodeAttacher(_props: IProps) {\n    const { nodes, ...props } = _props;\n    const ref = useDomNodeAttachment(nodes);\n    return <div {...props} ref={ref} />;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { useEffect } from \"react\";\n\nimport { EscapeListener } from \"@vanilla/dom-utils\";\n\n/**\n * React hook for listening for an escape press on the keyboard inside root element.\n *\n * When escape is pressed, the return element will be focused if provided or the callback will will be called.\n */\nexport function useEscapeListener({\n    root,\n    returnElement,\n    callback,\n}: {\n    root?: HTMLElement | null;\n    returnElement?: HTMLElement | null;\n    callback?: (event: KeyboardEvent) => void;\n}) {\n    useEffect(() => {\n        if (root === null || returnElement === null) {\n            // Bail out if these are null. That means we have unfilled refs. Undefined means they were not passed and we should use the defaults.\n            return;\n        }\n        const actualRoot = root || document.documentElement;\n        const escapeListener = new EscapeListener(actualRoot, returnElement, callback);\n        escapeListener.start();\n        return escapeListener.stop;\n    }, [root, returnElement, callback]);\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { useEffect, useLayoutEffect } from \"react\";\nimport { FocusWatcher } from \"@vanilla/dom-utils\";\n\n/**\n * React hook for creating and destroying a FocusWatcher. See FocusWatcher documentation.\n */\nexport function useFocusWatcher(\n    ref: React.RefObject<Element | null>,\n    changeHandler: (hasFocus: boolean) => void,\n    bypass?: boolean,\n) {\n    useLayoutEffect(() => {\n        if (bypass) {\n            return;\n        }\n        if (ref.current !== null) {\n            const focusWatcher = new FocusWatcher(ref.current, changeHandler);\n            focusWatcher.start();\n            return focusWatcher.stop;\n        }\n    }, [ref, changeHandler, bypass]);\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\nimport { useRef, useEffect } from \"react\";\n\n/**\n * Keep a reference to the previous value of something. (during the previous render).\n *\n * @param value\n */\nexport function useLastValue<T>(value: T): T | undefined {\n    const ref = useRef<T>();\n    useEffect(() => void (ref.current = value), [value]);\n    return ref.current;\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { useState } from \"react\";\n\n/**\n * Return a throw function for use inside of custom hooks & useEffect.\n *\n * This needed because throwing inside of `useEffect` does not propagate up to error boundaries.\n * @see https://github.com/facebook/react/issues/11334\n */\nexport function useThrowError(): (err: Error) => void {\n    const [error, setError] = useState<Error | null>(null);\n    if (error) {\n        throw error;\n    }\n\n    return setError;\n}\n","/**\n * Utility function related to logging/debugging.\n *\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nlet internalDebugValue = false;\n\n/**\n * Get or set the debug flag.\n *\n * @param newValue - The new value of debug.\n * @returns the current debug setting.\n */\nexport function debug(newValue?: boolean): boolean {\n    if (newValue !== undefined) {\n        internalDebugValue = newValue;\n    }\n\n    return internalDebugValue;\n}\n\n/**\n * Log something to console.\n * This only prints in debug mode.\n *\n * @param value - The value to log.\n */\nexport function logDebug(...value: any[]) {\n    if (internalDebugValue) {\n        // eslint-disable-next-line no-console\n        console.log(...value);\n    }\n}\n\n/**\n * Log something to console.\n * This only prints in debug mode, and if outputLog is true.\n *\n * @param outputLog - Condition to render log\n * @param value - The value to log.\n */\nexport function logDebugConditionnal(outputLog = false, ...value: any[]) {\n    if (internalDebugValue && outputLog) {\n        // eslint-disable-next-line no-console\n        console.log(...value);\n    }\n}\n\n/**\n * Log an error to console.\n * This will not run in test mode _unless_ debug is set to true.\n *\n * @param value - The value to log.\n */\nexport function logError(...value: any[]) {\n    if (!internalDebugValue && process.env.NODE_ENV === \"test\") {\n        return;\n    }\n    // eslint-disable-next-line no-console\n    console.error(...value);\n}\n\n/**\n * Log a warning to console.\n * This will not run in test mode _unless_ debug is set to true.\n *\n * @param value - The value to log.\n */\nexport function logWarning(...value: any[]) {\n    if (!internalDebugValue || process.env.NODE_ENV === \"test\") {\n        return;\n    }\n    // eslint-disable-next-line no-console\n    console.warn(...value);\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { ReactElement } from \"react\";\n\nexport interface IComponentMountOptions {\n    overwrite?: boolean;\n    clearContents?: boolean;\n    widgetResolver?: IWidgetResolver;\n    bypassPortalManager?: boolean;\n    unmountBeforeRender?: boolean;\n}\n\nexport interface IWidgetOptions {\n    $type?: string; // the component to get, optional because coming from API\n    children?: IWidgetOptions[]; // widgets to mount as children\n    [x: string]: any; // can take additional properties\n}\n\n/**\n * Defines an interface for a function that will turn widget options into props that can be used to render a component.\n */\nexport interface IWidgetResolver {\n    (options: IWidgetOptions): {\n        [key: string]: any;\n    };\n}\n\ninterface IPortal {\n    target: HTMLElement;\n    component: React.ReactElement;\n}\n\nlet hasRendered = false;\nconst portals: IPortal[] = [];\n\nconst PORTAL_MANAGER_ID = \"vanillaPortalManager\";\ntype PortalContextType = React.FC<{ children?: React.ReactNode }>;\nlet PortalContext: PortalContextType = (props) => {\n    return <React.Fragment>{props.children}</React.Fragment>;\n};\n\nexport function applySharedPortalContext(context: PortalContextType) {\n    PortalContext = context;\n    if (hasRendered) {\n        // Re-render the portals. We never want to be the first to initialize rendering though.\n        renderPortals();\n    }\n}\n\n/**\n * Component for managing all mounted components from a single wrapped context.\n *\n * This allows a shared context provider to be applied to parts of the site.\n */\nfunction PortalManager() {\n    return (\n        <div>\n            <PortalContext>\n                {portals.map((portal, i) => {\n                    return (\n                        <React.Fragment key={i}>\n                            {ReactDOM.createPortal(portal.component, portal.target)}\n                        </React.Fragment>\n                    );\n                })}\n            </PortalContext>\n        </div>\n    );\n}\n\nfunction renderPortals(callback?: () => void) {\n    hasRendered = true;\n    // Ensure we have our modal container.\n    let container = document.getElementById(PORTAL_MANAGER_ID);\n    if (!container) {\n        container = document.createElement(\"div\");\n        container.id = PORTAL_MANAGER_ID;\n        document.body.appendChild(container);\n    }\n\n    ReactDOM.render(<PortalManager />, container, callback);\n}\n\n/**\n * Mount a root component of a React tree.\n *\n * - ReactDOM render.\n * - Typestyle render.\n *\n * If the overwrite option is passed this component will replace the components you passed as target.\n *\n * Default Mode:\n * <div><TARGET /></div> -> <div><TARGET><REACT></TARGET><div>\n *\n * Overwrite Mode:\n * <div><TARGET /></div> -> <div><REACT/></div>\n */\nexport function mountReact(\n    component: React.ReactElement,\n    target: HTMLElement,\n    callback?: () => void,\n    options?: IComponentMountOptions & { bypassPortalManager?: boolean },\n) {\n    if (options?.bypassPortalManager) {\n        const doRender = () => {\n            ReactDOM.render(<PortalContext>{component}</PortalContext>, target, callback);\n        };\n        if (options?.unmountBeforeRender) {\n            ReactDOM.unmountComponentAtNode(target);\n        }\n        setImmediate(doRender);\n        return;\n    }\n\n    let mountPoint = target;\n    let cleanupContainer: HTMLElement | undefined;\n    if (options?.clearContents) {\n        target.innerHTML = \"\";\n    }\n\n    if (options && options.overwrite) {\n        const container = document.createElement(\"span\");\n        cleanupContainer = container;\n        target.parentElement!.insertBefore(container, target);\n        mountPoint = container;\n    }\n    portals.push({ target: mountPoint, component });\n\n    renderPortals(() => {\n        if (cleanupContainer) {\n            target.remove();\n            if (cleanupContainer.firstElementChild) {\n                cleanupContainer.parentElement!.insertBefore(cleanupContainer.firstElementChild, cleanupContainer);\n                cleanupContainer.remove();\n                target.remove();\n            }\n        }\n        callback && callback();\n    });\n}\n\nexport interface IMountable {\n    target: HTMLElement;\n    component: React.ReactElement;\n}\n\nexport function mountReactMultiple(components: IMountable[], callback?: () => void, options?: IComponentMountOptions) {\n    if (!components.length) {\n        return;\n    }\n\n    let toCleanup: Array<{ target: HTMLElement; cleanup: HTMLElement }> = [];\n    components.forEach(({ component, target }) => {\n        let mountPoint = target;\n        if (options?.clearContents) {\n            target.innerHTML = \"\";\n        }\n\n        if (options && options.overwrite) {\n            const container = document.createElement(\"span\");\n            toCleanup.push({\n                target,\n                cleanup: container,\n            });\n            target.parentElement!.insertBefore(container, target);\n            mountPoint = container;\n        }\n        portals.push({ target: mountPoint, component });\n    });\n\n    renderPortals(() => {\n        toCleanup.forEach(({ cleanup, target }) => {\n            if (cleanup.firstElementChild) {\n                cleanup.parentElement!.insertBefore(cleanup.firstElementChild, cleanup);\n                cleanup.remove();\n                target.remove();\n            }\n        });\n        callback && callback();\n    });\n}\n\n/**\n * Mount a modal with ReactDOM. This is only needed at the top level context.\n *\n * If you are already in a react context, just use `<Modal />`.\n * Note: Using this will clear any other modals mounted with this component.\n *\n * @param element The <Modal /> element to render.\n * @param containerID The container to render the modal into. Defaults to modal container.\n * @param asRealPortal Whether or not we should render this as a real portal, or one managed by the portal manager.\n */\nexport function mountPortal(element: ReactElement<any>, containerID: string, asRealPortal: boolean = false) {\n    // Ensure we have our modal container.\n    let container = document.getElementById(containerID);\n    if (!container) {\n        container = document.createElement(\"div\");\n        container.id = containerID;\n        document.body.appendChild(container);\n    }\n\n    if (asRealPortal) {\n        return ReactDOM.createPortal(element, container);\n    } else {\n        return new Promise((resolve) => mountReact(element, container!, () => resolve()));\n    }\n}\n","import { cssRaw, flattenNests } from \"@library/styles/styleShim\";\nimport { CSSObject } from \"@emotion/css\";\n\nexport function cssOut(selector: string, ...objects: CSSObject[]): void {\n    cssRaw({\n        [selector]: objects.map(flattenNests),\n    });\n}\n","/*\n * @author Alexander Kim <alexander.k@vanillaforums.com>\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { flexHelper } from \"@library/styles/styleHelpers\";\nimport { ColorsUtils } from \"@library/styles/ColorsUtils\";\nimport { styleUnit } from \"@library/styles/styleUnit\";\nimport { Mixins } from \"@library/styles/Mixins\";\nimport { styleFactory } from \"@library/styles/styleUtils\";\nimport { useThemeCache } from \"@library/styles/themeCache\";\nimport { globalVariables } from \"@library/styles/globalStyleVars\";\nimport { shadowHelper } from \"@library/styles/shadowHelpers\";\nimport { buttonGlobalVariables } from \"@library/forms/Button.variables\";\n\nexport const toastClasses = useThemeCache(() => {\n    const globalVars = globalVariables();\n    const style = styleFactory(\"toast\");\n\n    const root = () => {\n        return style(\"box\", {\n            fontSize: globalVars.fonts.size.medium,\n            zIndex: 1,\n            position: \"fixed\",\n            bottom: 18,\n            left: 18,\n            display: \"inline-block\",\n            ...Mixins.padding({\n                horizontal: globalVars.gutter.size,\n                top: globalVars.gutter.size,\n                bottom: globalVars.gutter.half,\n            }),\n            margin: styleUnit(globalVars.gutter.quarter),\n            ...Mixins.border(),\n            ...shadowHelper().dropDown(),\n            background: ColorsUtils.colorOut(globalVars.mainColors.bg),\n            p: {\n                margin: 0,\n            },\n        });\n    };\n\n    const buttons = style(\"button\", {\n        minHeight: buttonGlobalVariables().sizing.minHeight,\n        ...flexHelper().middleLeft(),\n    });\n\n    const button = style(\"button\", {\n        margin: styleUnit(\"3px\"),\n        fontSize: globalVars.fonts.size.medium,\n    });\n\n    return { root, buttons, button };\n});\n","/**\n * @author Alexander Kim <alexander.k@vanillaforums.com>\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { toastClasses } from \"@library/features/toaster/toastStyles\";\nimport Button from \"@library/forms/Button\";\nimport { ButtonTypes } from \"@library/forms/buttonTypes\";\nimport classNames from \"classnames\";\nimport ButtonLoader from \"@library/loaders/ButtonLoader\";\n\ninterface ILink {\n    name: string;\n    type: ButtonTypes;\n    onClick?: () => void;\n    isLoading?: boolean;\n}\n\ninterface IProps {\n    className?: string;\n    links: ILink[];\n    message: React.ReactNode;\n}\n\n/**\n * Renders toast message with links\n */\nexport default class Toast extends React.Component<IProps> {\n    public render() {\n        const { className, links, message } = this.props;\n        const classes = toastClasses();\n\n        return (\n            <div className={classNames(classes.root())}>\n                <p>{message}</p>\n                <div className={classes.buttons}>\n                    {links.map((link, i) => (\n                        <Button\n                            key={i}\n                            baseClass={link.type}\n                            title={link.name}\n                            className={classNames(classes.button)}\n                            onClick={link.onClick}\n                        >\n                            {link.isLoading ? <ButtonLoader buttonType={link.type} /> : link.name}\n                        </Button>\n                    ))}\n                </div>\n            </div>\n        );\n    }\n}\n","/**\n * @author Alexander Kim <alexander.k@vanillaforums.com>\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { ILoadable, LoadStatus } from \"@library/@types/api/core\";\nimport { produce } from \"immer\";\nimport { reducerWithInitialState } from \"typescript-fsa-reducers\";\nimport ThemeActions, { PreviewStatusType } from \"@library/theming/ThemeActions\";\nimport { useSelector } from \"react-redux\";\nimport { ICoreStoreState } from \"@library/redux/reducerRegistry\";\n\nexport interface IPreviewToasterState {\n    applyStatus: ILoadable<{ themeID: number | string }>;\n    cancelStatus: ILoadable<{ themeID: number | string }>;\n}\n\nexport interface IPreviewToasterStoreState extends ICoreStoreState {\n    themePreviewToaster: IPreviewToasterState;\n}\n\nconst DEFAULT_PREVIEW_TOASTER_STATE: IPreviewToasterState = {\n    applyStatus: {\n        status: LoadStatus.PENDING,\n    },\n    cancelStatus: {\n        status: LoadStatus.PENDING,\n    },\n};\n\nexport const themePreviewToastReducer = produce(\n    reducerWithInitialState<IPreviewToasterState>(DEFAULT_PREVIEW_TOASTER_STATE)\n        .case(ThemeActions.putCurrentThemeACs.started, (nextState, payload) => {\n            nextState.applyStatus.status = LoadStatus.LOADING;\n            nextState.applyStatus.data = {\n                themeID: payload.themeID,\n            };\n            return nextState;\n        })\n        .case(ThemeActions.putCurrentThemeACs.done, (nextState, payload) => {\n            nextState.applyStatus.status = LoadStatus.SUCCESS;\n            nextState.applyStatus.error = undefined;\n\n            return nextState;\n        })\n        .case(ThemeActions.putCurrentThemeACs.failed, (nextState, payload) => {\n            nextState.applyStatus.status = LoadStatus.ERROR;\n            nextState.applyStatus.error = payload.error;\n            return nextState;\n        })\n        .case(ThemeActions.putPreviewThemeACs.started, (nextState, payload) => {\n            if (payload.type === PreviewStatusType.CANCEL) {\n                nextState.cancelStatus.status = LoadStatus.LOADING;\n            }\n            nextState.cancelStatus.data = {\n                themeID: payload.themeID,\n            };\n            return nextState;\n        })\n        .case(ThemeActions.putPreviewThemeACs.done, (nextState, payload) => {\n            if (payload.params.type === PreviewStatusType.CANCEL) {\n                nextState.cancelStatus.status = LoadStatus.SUCCESS;\n            }\n            nextState.cancelStatus.error = undefined;\n\n            return nextState;\n        })\n        .case(ThemeActions.putPreviewThemeACs.failed, (nextState, payload) => {\n            nextState.cancelStatus.status = LoadStatus.ERROR;\n            nextState.cancelStatus.error = payload.error;\n            return nextState;\n        }),\n);\n\nexport function useThemePreviewToasterState() {\n    return useSelector((state: IPreviewToasterStoreState) => {\n        return state.themePreviewToaster;\n    });\n}\n","/**\n * @author Alexander Kim <alexander.k@vanillaforums.com>\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React, { useEffect, useState } from \"react\";\nimport { ButtonTypes } from \"@library/forms/buttonTypes\";\nimport Toast from \"@library/features/toaster/Toast\";\nimport { getMeta } from \"@library/utility/appUtils\";\nimport { PreviewStatusType, useThemeActions } from \"@library/theming/ThemeActions\";\nimport { useThemePreviewToasterState } from \"@library/features/toaster/themePreview/ThemePreviewToastReducer\";\nimport { LoadStatus } from \"@library/@types/api/core\";\nimport ErrorMessages from \"@library/forms/ErrorMessages\";\nimport { t } from \"@vanilla/i18n/src\";\nimport { RecordID } from \"@vanilla/utils\";\n\ninterface IThemePreview {\n    name: string;\n    redirect: string;\n    themeID: RecordID;\n    revisionID?: number;\n}\n\nexport function ThemePreviewToast() {\n    const { applyStatus, cancelStatus } = useThemePreviewToasterState();\n    const [themePreview, setThemePreview] = useState<IThemePreview | null>(getMeta(\"themePreview\", null));\n    const { putCurrentTheme, putPreviewTheme, patchThemeWithRevisionID } = useThemeActions();\n\n    const [restoringRevision, setRestoringRevision] = useState(false);\n    const [revisionRestored, setRevisionRestored] = useState(false);\n\n    const isRevisionPreview = themePreview?.revisionID ?? false;\n    const handleApply = async () => {\n        if (!themePreview) {\n            return;\n        }\n        if (isRevisionPreview) {\n            setRestoringRevision(true);\n            const updatedTheme = await patchThemeWithRevisionID({\n                themeID: themePreview.themeID,\n                revisionID: themePreview.revisionID,\n            });\n            if (updatedTheme) {\n                setRestoringRevision(false);\n                setRevisionRestored(true);\n            }\n            putPreviewTheme({ themeID: \"\", revisionID: undefined, type: PreviewStatusType.APPLY });\n        } else {\n            putCurrentTheme(themePreview.themeID);\n            putPreviewTheme({ themeID: \"\", type: PreviewStatusType.APPLY });\n        }\n    };\n\n    const handleCancel = async () => {\n        putPreviewTheme({ themeID: \"\", type: PreviewStatusType.CANCEL });\n    };\n\n    useEffect(() => {\n        if (!themePreview) {\n            return;\n        }\n        if (\n            (themePreview.name && applyStatus.status === LoadStatus.SUCCESS) ||\n            cancelStatus.status === LoadStatus.SUCCESS ||\n            revisionRestored\n        ) {\n            window.location.href = isRevisionPreview\n                ? `/theme/theme-settings/${themePreview.themeID}/revisions`\n                : themePreview.redirect;\n        }\n    });\n\n    if (!themePreview) {\n        return null;\n    }\n\n    return (\n        <Toast\n            links={[\n                {\n                    name: isRevisionPreview ? t(\"Restore\") : t(\"Apply\"),\n                    type: ButtonTypes.TEXT,\n                    onClick: handleApply,\n                    isLoading:\n                        applyStatus.status === LoadStatus.LOADING ||\n                        applyStatus.status === LoadStatus.SUCCESS ||\n                        restoringRevision,\n                },\n                {\n                    name: t(\"Cancel\"),\n                    type: ButtonTypes.TEXT_PRIMARY,\n                    onClick: handleCancel,\n                    isLoading: cancelStatus.status === LoadStatus.LOADING || cancelStatus.status === LoadStatus.SUCCESS,\n                },\n            ]}\n            message={\n                <>\n                    You are previewing the <b>{themePreview.name}</b> theme.\n                    {applyStatus.error && <ErrorMessages errors={[applyStatus.error]} />}\n                </>\n            }\n        />\n    );\n}\n","/**\n * @copyright 2009-2019 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport React from \"react\";\nimport { onReady, t } from \"@library/utility/appUtils\";\nimport { addComponent } from \"@library/utility/componentRegistry\";\nimport Toast from \"@library/features/toaster/Toast\";\nimport { ThemePreviewToast } from \"@library/features/toaster/themePreview/ThemePreviewToast\";\nimport { themePreviewToastReducer } from \"@library/features/toaster/themePreview/ThemePreviewToastReducer\";\nimport { registerReducer } from \"@library/redux/reducerRegistry\";\nimport { mountPortal } from \"@vanilla/react-utils\";\nimport { roleReducer } from \"@dashboard/roles/roleReducer\";\nimport { SearchService } from \"@library/search/SearchService\";\nimport { TypeGroupsIcon } from \"@vanilla/library/src/scripts/icons/searchIcons\";\nimport { PLACES_GROUP_TYPE } from \"@vanilla/library/src/scripts/search/searchConstants\";\nimport { PlacesSearchTypeFilter } from \"@dashboard/components/panels/PlacesSearchTypeFilter\";\n\nconst PREVIEW_CONTAINER = \"previewContainer\";\n\n// Routing\n\nregisterReducer(\"themePreviewToaster\", themePreviewToastReducer);\nregisterReducer(\"roles\", roleReducer);\n\naddComponent(\"toaster\", Toast);\nonReady(() => {\n    mountPortal(<ThemePreviewToast />, PREVIEW_CONTAINER);\n});\n","/**\n * Set wepback's public path.\n * Otherwise the lookups of dynamically imported webpack files can fail on sites that have a different webroot\n * Eg. installed in a subfolder / using Reverse Proxy.\n *\n * @author Adam Charron <adam.c@vanillaforums.com>\n * @copyright 2009-2018 Vanilla Forums Inc.\n * @license GPL-2.0-only\n */\n\nimport { assetUrl, getMeta } from \"@library/utility/appUtils\";\n\n/**\n * This needs to be a free variable.\n *\n * Webpack does some magic to make this work.\n * It you try and set a local or global version of it, it WILL NOT work.\n *\n * @see https://stackoverflow.com/questions/12934929/what-are-free-variables\n * @see https://webpack.js.org/configuration/output/#output-publicpath\n * @see https://github.com/webpack/webpack/issues/2776#issuecomment-233208623\n */\n// @ts-ignore: Cannot find variable warning. See comment aboe.\n__webpack_public_path__ = assetUrl(\"/dist/\" + __BUILD__SECTION__ + \"/\");\n"],"sourceRoot":""}